<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
<title>
  HCPC 2011 Spring Online Contest 解题报告 |  Static Oneplus
</title>
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap-responsive.min.css">
<style type="text/css">
.prettyprint ol.linenums > li { list-style-type: decimal; }
.nav { }
.nav li { float: left; width: 70px; }
.content { padding: 30px 0; }
body, h1, h2, h3, h4 { font-family: "Fjalla One","Georgia","Helvetica Neue",Arial,sans-serif;}
header { width: 100%; height: 80px;}
blockquote p { font-size: 14px; }
</style>
</head>
<body>

<div class="container">
  <header class="header">
    <h1 class="site_title">Static Oneplus <small>不可控制论</small></h1>
    <ul class="nav pull-right">
      <li><a href="/">Home</a></li>
      <li><a href="/cv">CV</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/notes">Notes</a></li>
      <li><a href="/feed.xml">RSS</a></li>
    </ul>
  </header>

  <div class="content">
    <div style="color:#999;">
  <small>2011/05/12 - by
    Oneplus

    
      &bull; <a href="/blog/tags/acm-group.html">ACM Group</a>
    
      &bull; <a href="/blog/tags/hcpc-2011-spring.html">HCPC 2011 Spring</a>
    
  </small>
</div>
<h2>HCPC 2011 Spring Online Contest 解题报告</h2>
<hr />
<div>
  <p>这篇本该是校赛之后就放出来的解题报告终于被我拖啊拖啊拖到了现在，大家拍死我吧。</p>

<div>_________________________我是被拍死的分割线_________________________</div>

<p>比赛前收到了16道题，其中有一道数据范围描述不好，而且标程做法也不是很科学，所以就bang掉。后来又害怕没有水题做，我就独断，祭出了上次校赛因为水过头而被bang掉的Default Password。整体评价一下难度（sevenzero版）</p>

<table width="100%">
<tr style="background:#eee"><th>Pid</th><th>Title</th><th>Author</th><th>Category</th><th>Expected Difficulty(5)</th></tr>
<tr><td><a href="http://acm.hit.edu.cn/judge/show.php?Proid=3016">A</a></td>
<td>RPNF</td><td>yangjing</td><td>表达式求值</td><td>1</td></tr>
<tr><td><a href="http://acm.hit.edu.cn/judge/show.php?Proid=3017">B</a></td>
<td>Default Password</td><td>Unknown</td><td>水</td><td>0</td></tr>
<tr><td><a href="http://acm.hit.edu.cn/judge/show.php?Proid=3018">C</a></td>
<td>Censorship</td><td>sevenzero</td><td>字符串、DP</td><td>2.5</td></tr>
<tr><td><a href="http://acm.hit.edu.cn/judge/show.php?Proid=3019">D</a></td>
<td>The Final Battle of Daydream</td><td>jerrybond</td><td>智力题</td><td>1.5</td></tr>
<tr><td><a href="http://acm.hit.edu.cn/judge/show.php?Proid=3020">E</a></td>
<td>Costume Party</td><td>chenyuanqin</td><td>暴搜，数学</td><td>3</td></tr>
<tr><td><a href="http://acm.hit.edu.cn/judge/show.php?Proid=3021">F</a></td>
<td>Go Home</td><td>icek</td><td>最短路</td><td>2.5</td></tr>
<tr><td><a href="http://acm.hit.edu.cn/judge/show.php?Proid=3022">G</a></td>
<td>Alex's Problem</td><td>胡越</td><td>几何、胡越题</td><td>4</td></tr>
<tr><td><a href="http://acm.hit.edu.cn/judge/show.php?Proid=3015">H</a></td>
<td>Zhou Yi II</td><td>sevenzero</td><td>水</td><td>0</td></tr>
</table>

<p>实际结果是70学长对于自己的题目难度估计不足，比赛中只有4次通过。而icek的最短路由于比较赤裸，被大家纷纷ac。所以感觉Go Home打2分，Censorship打3分比较合适。当然这是事后诸葛了。阿沁的搜索其实难度不大，数据也不是很硬，但是比赛时还是卡了一批人。完全可以水一水吗~</p>

<div>_________________________我是被拍死的分割线_________________________</div>

<h4 id="rpnf">RPNF</h4>

<p>基本的表达式求值，中缀转后缀。按照yangjing学长的说法，两个栈就可以搞定的题。不过描述上略有瑕疵，没有提到a-b-c的情况。在算符优先级的表述上也有一定的混淆。还有，据羊说，用scanf会出错，gets过，不知道数据中是不是有空格，没有深入辨证。</p>

<p>具体算法是维护两个栈，一个放操作数，一个放操作符。判断扫描到的字符。如果是左括号，直接放入操作符栈，如果是右括号，就一直弹栈到遇到左括号，如果是操作数，直接放入操作数栈。如果是操作符，要判断栈顶和扫描字符的优先级，后者高则把后者放到操作数栈，否则一直弹栈到后者高于前者。</p>

<pre class="highlight cpp"><span class="cp">#include &lt;iostream&gt;
#include &lt;cstring&gt;
#include &lt;cmath&gt;
#define PRINT(x) cout &lt;&lt;(#x)&lt;&lt;&amp;quot; &amp;quot;&lt;&lt;x&lt;&lt;endl;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">SIZE</span> <span class="o">=</span> <span class="mi">512</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">legal</span><span class="p">(</span><span class="kt">char</span> <span class="n">ch</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="sc">')'</span><span class="p">)</span> <span class="k">return</span> <span class="mi">4</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="sc">'('</span><span class="p">)</span> <span class="k">return</span> <span class="mi">3</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="sc">'+'</span> <span class="o">||</span> <span class="n">ch</span> <span class="o">==</span> <span class="sc">'-'</span> <span class="o">||</span> <span class="n">ch</span> <span class="o">==</span> <span class="sc">'*'</span> <span class="o">||</span> <span class="n">ch</span> <span class="o">==</span> <span class="sc">'/'</span> <span class="o">||</span> <span class="n">ch</span> <span class="o">==</span> <span class="sc">'^'</span><span class="p">)</span> <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ch</span> <span class="o">&gt;=</span> <span class="sc">'a'</span> <span class="o">&amp;&amp;</span> <span class="n">ch</span> <span class="o">&lt;=</span> <span class="sc">'z'</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">pri</span><span class="p">(</span><span class="kt">char</span> <span class="n">ch</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="sc">'+'</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="sc">'-'</span><span class="p">)</span> <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="sc">'*'</span><span class="p">)</span> <span class="k">return</span> <span class="mi">3</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="sc">'/'</span><span class="p">)</span> <span class="k">return</span> <span class="mi">4</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="sc">'^'</span><span class="p">)</span> <span class="k">return</span> <span class="mi">5</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="n">op</span><span class="p">[</span><span class="n">SIZE</span><span class="p">],</span><span class="n">opn</span><span class="p">[</span><span class="n">SIZE</span><span class="p">],</span> <span class="n">ch</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">cas</span><span class="p">,</span> <span class="n">opTop</span><span class="p">,</span> <span class="n">opnTop</span><span class="p">;</span>
    <span class="n">scanf</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">cas</span> <span class="p">);</span>
    <span class="n">getchar</span><span class="p">();</span>
    <span class="k">while</span><span class="p">(</span><span class="n">cas</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">string</span> <span class="n">buf</span><span class="p">;</span>
        <span class="n">getline</span><span class="p">(</span> <span class="n">cin</span><span class="p">,</span> <span class="n">buf</span> <span class="p">);</span> <span class="c1">//PRINT(buf);
</span>        <span class="kt">int</span> <span class="n">kind</span><span class="p">;</span> <span class="n">opTop</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">opnTop</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">buf</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">//PRINT(buf[i]);
</span>            <span class="k">if</span><span class="p">((</span><span class="n">kind</span> <span class="o">=</span> <span class="n">legal</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="n">kind</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span>      <span class="p">{</span> <span class="k">while</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="n">opTop</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">'('</span><span class="p">)</span> <span class="n">opn</span><span class="p">[</span><span class="o">++</span> <span class="n">opnTop</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span><span class="p">[</span><span class="n">opTop</span> <span class="o">--</span><span class="p">];</span> <span class="o">--</span><span class="n">opTop</span><span class="p">;</span> <span class="p">}</span>
                <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">kind</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span> <span class="n">op</span><span class="p">[</span><span class="o">++</span> <span class="n">opTop</span><span class="p">]</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="p">}</span>
                <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">kind</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">pri</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;</span><span class="n">pri</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="n">opTop</span><span class="p">]))</span> <span class="n">op</span><span class="p">[</span><span class="o">++</span> <span class="n">opTop</span><span class="p">]</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                    <span class="k">else</span> <span class="p">{</span> <span class="k">while</span><span class="p">(</span><span class="n">pri</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;=</span><span class="p">(</span><span class="n">pri</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="n">opTop</span><span class="p">])))</span> <span class="n">opn</span><span class="p">[</span><span class="o">++</span> <span class="n">opnTop</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span><span class="p">[</span><span class="n">opTop</span> <span class="o">--</span><span class="p">];</span> <span class="n">op</span><span class="p">[</span><span class="o">++</span> <span class="n">opTop</span><span class="p">]</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">];}}</span>
                <span class="k">else</span> <span class="n">opn</span><span class="p">[</span><span class="o">++</span> <span class="n">opnTop</span><span class="p">]</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="c1">//PRINT(opTop); PRINT(opnTop); PRINT(i);
</span>        <span class="p">}</span>
        <span class="c1">//PRINT(opnTop);
</span>        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">opnTop</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span> <span class="n">putchar</span><span class="p">(</span><span class="n">opn</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">opTop</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">--</span><span class="p">)</span>   <span class="n">putchar</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span> <span class="n">putchar</span><span class="p">(</span><span class="sc">'\n'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>

<h4 id="default-password">Default Password</h4>

<p>判断输入字符串是不是”wujiawei”…</p>

<h4 id="censorship">Censorship</h4>

<p>这个等70学长补一个解题报告吧。</p>

<p><strong>[05.20更新]</strong>
预处理先将不同的单词向整数做一个映射，可以用map实现，这样单词都被整数替代了，操作起来会方便很多。</p>

<p>用dp[i][j]表示sensitive information的前j个单词组成的子列在internet information的前i个单词组成的子序列中出现的次数。</p>

<p>转移方程是dp[i][j]=dp[i-1][j-1]+dp[i-1][j] (internet information的第i个单词和sensitive information的第j个单词相同) 和 dp[i][j]=dp[i-1][j] (internet information的第i个单词和sensitive information的第j个单词不同)。</p>

<p>加上negative单词情况后，就先将negative单词从从sensitive information中除去，如果它前面是第i个单词就在一个数组neg中把neg[i]标记为negative单词。再加一个转移方程dp[i][j]=0 (neg[j]与internet information的第i个单词相同)，即出现了internet information中出现了negative单词，sensitive information的前j个单词组成的所有子序列不可能最后转移到dp[n][m]，故将dp[i][j]置0。最后dp[n][m]为答案，n是internet information中单词数，m是sensitive information中非负单词数。</p>

<pre class="highlight cpp"><span class="cp">#include &lt;vector&gt;
#include &lt;list&gt;
#include &lt;map&gt;
#include &lt;set&gt;
#include &lt;deque&gt;
#include &lt;stack&gt;
#include &lt;bitset&gt;
#include &lt;algorithm&gt;
#include &lt;functional&gt;
#include &lt;numeric&gt;
#include &lt;utility&gt;
#include &lt;sstream&gt;
#include &lt;iostream&gt;
#include &lt;iomanip&gt;
#include &lt;cstdio&gt;
#include &lt;cmath&gt;
#include &lt;cstdlib&gt;
#include &lt;ctime&gt;
#include &lt;cstring&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="cp">#define ALL(c) (c).begin(),(c).end()
#define FIL(c,n) memset(c,n,sizeof(c))
#define L 100001
#define N 22
#define W 33
#define MOD 10007
</span>
<span class="kt">int</span> <span class="n">dp</span><span class="p">[</span><span class="n">L</span><span class="p">][</span><span class="n">N</span><span class="p">];</span>

<span class="n">map</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">mp</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">ins</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">n</span><span class="o">=</span><span class="n">mp</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mp</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">mp</span><span class="p">[</span><span class="n">s</span><span class="p">];</span>
    <span class="k">else</span>
       <span class="k">return</span> <span class="n">mp</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="n">n</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">bool</span> <span class="nf">isc</span><span class="p">(</span><span class="kt">char</span> <span class="n">c</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">&gt;=</span><span class="sc">'A'</span><span class="o">&amp;&amp;</span><span class="n">c</span><span class="o">&lt;=</span><span class="sc">'Z'</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="o">&gt;=</span><span class="sc">'a'</span><span class="o">&amp;&amp;</span><span class="n">c</span><span class="o">&lt;=</span><span class="sc">'z'</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="c1">//freopen(&amp;quot;censorship.in&amp;quot;,&amp;quot;r&amp;quot;,stdin);
</span>	<span class="c1">//freopen(&amp;quot;censorship.out&amp;quot;,&amp;quot;w&amp;quot;,stdout);
</span>    <span class="kt">int</span> <span class="n">cas</span><span class="p">;</span>
    <span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span><span class="o">&amp;</span><span class="n">cas</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">ct</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">ct</span><span class="o">&lt;</span><span class="n">cas</span><span class="p">;</span><span class="n">ct</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">mp</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
        <span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
        <span class="kt">char</span> <span class="n">seq</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">W</span><span class="p">];</span>
        <span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="n">L</span><span class="p">];</span>
        <span class="kt">int</span> <span class="n">word</span><span class="p">[</span><span class="n">L</span><span class="p">];</span>
        <span class="kt">int</span> <span class="n">cnt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">neg</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">pos</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
        <span class="n">FIL</span><span class="p">(</span><span class="n">neg</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">FIL</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">s</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="sc">'!'</span><span class="p">)</span>
                <span class="n">neg</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span><span class="o">=</span><span class="n">ins</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span>
            <span class="k">else</span>
                <span class="n">pos</span><span class="p">[</span><span class="o">++</span><span class="n">cnt</span><span class="p">]</span><span class="o">=</span><span class="n">ins</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
        <span class="p">}</span>
        <span class="n">gets</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
        <span class="n">gets</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">cw</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">isc</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="p">{</span>
                <span class="n">string</span> <span class="n">ts</span><span class="p">;</span>
                <span class="kt">int</span> <span class="n">j</span><span class="p">;</span>
                <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">;</span><span class="n">isc</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
                    <span class="n">ts</span><span class="o">+=</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
                <span class="n">i</span><span class="o">=</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
                <span class="n">word</span><span class="p">[</span><span class="o">++</span><span class="n">cw</span><span class="p">]</span><span class="o">=</span><span class="n">ins</span><span class="p">(</span><span class="n">ts</span><span class="p">);</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">FIL</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">cw</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">cnt</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">&amp;&amp;</span><span class="n">pos</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
                <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">neg</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="n">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span><span class="err">\</span><span class="n">n</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span><span class="n">dp</span><span class="p">[</span><span class="n">cw</span><span class="p">][</span><span class="n">cnt</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>

<h4 id="the-final-battle-of-daydream">The Final Battle of Daydream</h4>

<p><strong>[By jerrybond]</strong>本题很容易想到的解法是，申请一个大小为300,000的布尔数组，用来标记哪些数字出现过，哪些没有，这样很容易就能找到丢失的两个数字了。时间复杂度O(n)，空间复杂度也是O(n)。但遗憾的是，在1024K 的内存限制下，这种做法是行不通的。</p>

<p>仔细观察题目，也许你不禁会问：为什么只有两个士兵丢失，而不是1000或10000 个呢？事实上，我们只需要知道这两个数字的和与积，就可以通过解二元方程组得到要找的两个数字，而无需消耗过多的内存。
设丢失的两个士兵的编号为a、b，那么</p>

<ul>
<li>a+b=sum(i)-sum(left)</li>
<li>a<sup>2</sup>+b<sup>2</sup>=sum(i<sup>2</sup>)-sum(left<sup>2</sup>)</li>
</ul>

<p>剩下的就是解一元二次方程的事情了。</p>

<pre class="highlight cpp"><span class="cp">#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;cmath&gt;
#define sqr(x) ((x)*(x))
#define PRINT(x) cout &lt;&lt;(#x)&lt;&lt;&amp;quot; &amp;quot;&lt;&lt;x&lt;&lt;endl;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">double</span> <span class="n">n</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">lf</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
        <span class="kt">double</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">double</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">N</span> <span class="o">+</span> <span class="n">i</span><span class="p">;</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="n">sqr</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">double</span> <span class="n">x</span><span class="p">;</span> <span class="n">scanf</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">lf</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">x</span> <span class="p">);</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">N</span> <span class="o">-</span> <span class="n">x</span><span class="p">;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">M</span> <span class="o">-</span> <span class="n">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kt">double</span> <span class="n">delta</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">M</span> <span class="o">-</span> <span class="n">sqr</span><span class="p">(</span><span class="n">N</span><span class="p">));</span>
        <span class="c1">//printf( &amp;quot;TEST %.10lf %.10lf %.10lf\n&amp;quot;, N, M, delta);
</span>        <span class="kt">double</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">delta</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="n">delta</span><span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="mf">.0</span><span class="n">lf</span> <span class="o">%</span><span class="mf">.0</span><span class="n">lf</span><span class="err">\</span><span class="n">n</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>

<h4 id="costume-party">Costume Party</h4>

<p><strong>[By chenyuanqin]</strong>很明显，可以抽象成一个图论模型：每个女生当成一个点，所有认识的人之间连接一条边。每一种服装就是一种颜色。那么，就是用m种颜色给这个图点染色，每条边的两个顶点颜色不能一样，计算染色方案。</p>

<ol><li>完全图k的用m种颜色方案数 f（k，m）= m * （m-1）*。。。（m-k+1） 完全图，两两之间有边，不能有任何两个点颜色一样。</li>
<li>普通的图G对于不存在的边（u，v）。 f（G）= f（G + (u，v)）+ f（G/(u，v)）对于G的所有染色方案，u，v要么颜色不一样，那么它在f（G+(u，v)）中。如果u，v颜色一样，那么它在f（G/(u，v)）中，G/(u，v)为点收缩操作，即将u，v糅合成一个点w，它关联所有u，v关联的顶点。</li></ol>

<p>不断进行2操作，那么G将会变成一个个的完全图，然后分别用1来计算即可。</p>

<pre class="highlight cpp"><span class="cp">#include &lt;iostream&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;algorithm&gt;
#include &lt;math.h&gt;
#include &lt;string.h&gt;
#include &lt;fstream&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="cp">#define mod 9999997
</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k</span> <span class="p">;</span>
<span class="n">bool</span> <span class="n">adj</span><span class="p">[</span> <span class="mi">11</span> <span class="p">][</span> <span class="mi">11</span> <span class="p">];</span>
<span class="n">bool</span> <span class="n">del</span><span class="p">[</span> <span class="mi">11</span> <span class="p">];</span>
<span class="kt">int</span> <span class="n">a</span><span class="p">[</span> <span class="mi">100001</span> <span class="p">][</span> <span class="mi">11</span> <span class="p">];</span>
<span class="kt">void</span> <span class="nf">find_not</span><span class="p">(</span> <span class="kt">int</span><span class="o">*</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span><span class="o">*</span> <span class="n">b</span> <span class="p">)</span>
<span class="p">{</span>
     <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
     <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">del</span><span class="p">[</span> <span class="n">i</span> <span class="p">]</span> <span class="p">)</span>
     <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span> <span class="p">)</span>
     <span class="p">{</span>
         <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">del</span><span class="p">[</span> <span class="n">j</span> <span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">adj</span><span class="p">[</span> <span class="n">i</span> <span class="p">][</span> <span class="n">j</span> <span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span> <span class="p">)</span>
         <span class="p">{</span>
             <span class="o">*</span><span class="n">a</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="o">*</span><span class="n">b</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
             <span class="k">return</span><span class="p">;</span>
         <span class="p">}</span>
     <span class="p">}</span>
     <span class="o">*</span><span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">getNum</span><span class="p">(</span> <span class="kt">int</span> <span class="n">t</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="c1">//printf( &amp;quot;t %d\n&amp;quot;, t );
</span>    <span class="k">if</span> <span class="p">(</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="n">m</span> <span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[</span> <span class="n">m</span> <span class="p">][</span> <span class="n">t</span> <span class="p">];</span>
<span class="p">}</span>
<span class="c1">//int ttt = 0;
</span><span class="kt">int</span> <span class="nf">dfs</span><span class="p">(</span> <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
  <span class="c1">//  ttt++;
</span>   <span class="c1">// if ( ttt % 10000 == 0 )
</span>   <span class="c1">// printf( &amp;quot;%d\n&amp;quot;, ttt );
</span>    <span class="n">bool</span> <span class="n">temp</span><span class="p">[</span> <span class="mi">101</span> <span class="p">];</span>
    <span class="n">adj</span><span class="p">[</span> <span class="n">v</span> <span class="p">][</span> <span class="n">u</span> <span class="p">]</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span> <span class="n">u</span> <span class="p">][</span> <span class="n">v</span> <span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">find_not</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span> <span class="p">);</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span> <span class="n">a</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="n">getNum</span><span class="p">(</span> <span class="n">num</span> <span class="p">)</span> <span class="o">:</span> <span class="n">dfs</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">num</span> <span class="p">)</span> <span class="p">);</span>
    <span class="n">adj</span><span class="p">[</span> <span class="n">v</span> <span class="p">][</span> <span class="n">u</span> <span class="p">]</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span> <span class="n">u</span> <span class="p">][</span> <span class="n">v</span> <span class="p">]</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

    <span class="n">del</span><span class="p">[</span> <span class="n">v</span> <span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
    <span class="n">temp</span><span class="p">[</span> <span class="n">i</span> <span class="p">]</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span> <span class="n">u</span> <span class="p">][</span> <span class="n">i</span> <span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
    <span class="n">adj</span><span class="p">[</span> <span class="n">i</span> <span class="p">][</span> <span class="n">u</span> <span class="p">]</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span> <span class="n">u</span> <span class="p">][</span> <span class="n">i</span> <span class="p">]</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span> <span class="n">u</span> <span class="p">][</span> <span class="n">i</span> <span class="p">]</span> <span class="o">|</span> <span class="n">adj</span><span class="p">[</span> <span class="n">v</span> <span class="p">][</span> <span class="n">i</span> <span class="p">];</span>
    <span class="n">find_not</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span> <span class="p">);</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span> <span class="n">a</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="n">getNum</span><span class="p">(</span> <span class="n">num</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">:</span> <span class="n">dfs</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">num</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">);</span>
    <span class="n">del</span><span class="p">[</span> <span class="n">v</span> <span class="p">]</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
    <span class="n">adj</span><span class="p">[</span> <span class="n">i</span> <span class="p">][</span> <span class="n">u</span> <span class="p">]</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span> <span class="n">u</span> <span class="p">][</span> <span class="n">i</span> <span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span> <span class="n">i</span> <span class="p">];</span>

    <span class="k">return</span> <span class="n">res</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">solve</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
    <span class="n">find_not</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v</span> <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">u</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">getNum</span><span class="p">(</span> <span class="n">n</span> <span class="p">);</span>
    <span class="k">return</span> <span class="n">dfs</span><span class="p">(</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span> <span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">cas</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">freopen</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">costume</span><span class="p">.</span><span class="n">in</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">r</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="n">stdin</span> <span class="p">);</span>
    <span class="n">freopen</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">costume</span><span class="p">.</span><span class="n">out</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">w</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="n">stdout</span> <span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100001</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">a</span><span class="p">[</span> <span class="n">i</span> <span class="p">][</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span> <span class="n">i</span><span class="p">,</span> <span class="mi">10</span> <span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">temp</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">a</span><span class="p">[</span> <span class="n">i</span> <span class="p">][</span> <span class="n">j</span> <span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">1LL</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span> <span class="n">i</span> <span class="p">][</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">]</span> <span class="o">*</span> <span class="mi">1LL</span> <span class="o">*</span> <span class="p">(</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span> <span class="n">scanf</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">k</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
        <span class="n">memset</span><span class="p">(</span> <span class="n">adj</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span> <span class="n">adj</span> <span class="p">)</span> <span class="p">);</span>
        <span class="n">memset</span><span class="p">(</span> <span class="n">del</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span> <span class="n">del</span> <span class="p">)</span> <span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">scanf</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span> <span class="p">);</span>
            <span class="n">adj</span><span class="p">[</span> <span class="n">a</span> <span class="p">][</span> <span class="n">b</span> <span class="p">]</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span> <span class="n">b</span> <span class="p">][</span> <span class="n">a</span> <span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">printf</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Case</span> <span class="err">#</span><span class="o">%</span><span class="n">d</span><span class="err">\</span><span class="n">n</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">++</span><span class="n">cas</span> <span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span><span class="err">\</span><span class="n">n</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="n">solve</span><span class="p">()</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>

<p>短小暴力赤裸版见下。</p>

<pre class="highlight cpp"><span class="cp">#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;queue&gt;
#include &lt;cstring&gt;
#define sz(x) ((int)(x).size())
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">MOD</span> <span class="o">=</span> <span class="mi">9999997</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">LL</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">G</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">clr</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="n">LL</span> <span class="n">C</span><span class="p">[</span><span class="mi">100001</span><span class="p">][</span><span class="mi">11</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">now</span><span class="p">,</span> <span class="kt">int</span> <span class="n">kind</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">now</span> <span class="o">==</span> <span class="n">n</span><span class="p">){</span>
        <span class="n">res</span><span class="p">[</span><span class="n">kind</span><span class="p">]</span> <span class="o">++</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">kind</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">clr</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="n">bool</span> <span class="n">flag</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span><span class="p">)</span> <span class="k">if</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="n">now</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">clr</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">==</span> <span class="n">clr</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">{</span><span class="n">flag</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span> <span class="k">break</span><span class="p">;}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="n">dfs</span><span class="p">(</span><span class="n">now</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">kind</span><span class="p">);</span>
        <span class="n">clr</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">clr</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="n">kind</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">dfs</span><span class="p">(</span><span class="n">now</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">kind</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">clr</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="n">init</span><span class="p">(){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mi">100000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="n">i</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mi">100000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;=</span><span class="n">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">cas</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">init</span><span class="p">();</span>
    <span class="k">while</span><span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span><span class="o">%</span><span class="n">d</span><span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">){</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">G</span><span class="p">));</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">res</span><span class="p">));</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
            <span class="n">scanf</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span><span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v</span> <span class="p">);</span> <span class="n">u</span> <span class="o">--</span><span class="p">;</span> <span class="n">v</span> <span class="o">--</span><span class="p">;</span>
            <span class="n">G</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">kind</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">dfs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">kind</span><span class="p">);</span>
        <span class="n">LL</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0L</span><span class="p">;</span> <span class="n">LL</span> <span class="n">pw</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">pw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pw</span> <span class="o">*</span> <span class="p">(</span><span class="n">LL</span><span class="p">)</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
            <span class="c1">//cout &lt;&lt; pw &lt;&lt; endl;
</span>            <span class="n">ans</span> <span class="o">=</span> <span class="p">((</span><span class="n">ans</span><span class="o">+</span><span class="p">((</span><span class="n">C</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">)</span> <span class="o">*</span> <span class="n">pw</span><span class="p">)</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">)</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Case</span> <span class="err">#</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span> <span class="o">&lt;&lt;</span> <span class="o">++</span> <span class="n">cas</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>

<h4 id="go-home">Go Home</h4>

<p><strong>[By icek]</strong>此题本意是考察堆优化dijkstra变形，事实上用动态规划，拆点最短路什么的都可以做。</p>

<p>解决问题的核心是用数组<code>dis[i][j]</code>记录在走到点i并且花费为j的情况下所需要的最小时间，即将原来dijkstra算法中记录最小状态的一维数组改成两维来表示。</p>

<p>因为堆优化dijkstra中以时间最小来维护堆，所以当要对终点做拓展的时候直接退出，就可以保证所用时间最小，输出最小值即可。</p>

<pre class="highlight cpp"><span class="cp">#include &lt;iostream&gt;
#include &lt;cstdio&gt;
#include &lt;algorithm&gt;
#include &lt;cstring&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">505</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">INF</span> <span class="o">=</span> <span class="mh">0x3fffffff</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">first</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">edge</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">next</span><span class="p">;</span>
<span class="p">}</span> <span class="n">g</span><span class="p">[</span><span class="n">N</span> <span class="o">*</span> <span class="mi">4</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="kt">int</span> <span class="n">t</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">g</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
    <span class="n">g</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
    <span class="n">g</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
    <span class="n">g</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>
    <span class="n">g</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">next</span> <span class="o">=</span> <span class="n">first</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
    <span class="n">first</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnt</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">node</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">w</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">t</span><span class="p">;</span>
    <span class="n">bool</span> <span class="k">operator</span> <span class="o">&lt;</span> <span class="p">(</span> <span class="k">const</span> <span class="n">node</span> <span class="o">&amp;</span><span class="n">a</span> <span class="p">)</span> <span class="k">const</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">.</span><span class="n">t</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">dis</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">];</span>
<span class="n">bool</span> <span class="n">used</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">];</span>
<span class="n">node</span> <span class="n">queue</span><span class="p">[</span><span class="n">N</span> <span class="o">*</span> <span class="n">N</span><span class="p">];</span>

<span class="n">bool</span> <span class="nf">relax</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">w</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="kt">int</span> <span class="n">t</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">w</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">w</span> <span class="o">+</span> <span class="n">c</span><span class="p">])</span>
    <span class="p">{</span>
        <span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">w</span> <span class="o">+</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">w</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">dij</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">C</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="n">dis</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">INF</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">used</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">used</span><span class="p">));</span>

    <span class="kt">int</span> <span class="n">tail</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">t</span><span class="p">;</span>

    <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">queue</span><span class="p">[</span><span class="n">tail</span><span class="p">].</span><span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
    <span class="n">queue</span><span class="p">[</span><span class="n">tail</span><span class="p">].</span><span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">queue</span><span class="p">[</span><span class="n">tail</span><span class="p">].</span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">tail</span><span class="o">++</span><span class="p">;</span>
    <span class="n">make_heap</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span> <span class="n">queue</span> <span class="o">+</span> <span class="n">tail</span><span class="p">);</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">tail</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">pop_heap</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span> <span class="n">queue</span> <span class="o">+</span> <span class="n">tail</span><span class="p">);</span>
        <span class="n">tail</span><span class="o">--</span><span class="p">;</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">queue</span><span class="p">[</span><span class="n">tail</span><span class="p">].</span><span class="n">u</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">u</span> <span class="o">==</span> <span class="n">n</span> <span class="p">)</span> <span class="k">break</span><span class="p">;</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">queue</span><span class="p">[</span><span class="n">tail</span><span class="p">].</span><span class="n">w</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">used</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">w</span><span class="p">]</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">used</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">first</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="n">tmp</span> <span class="p">;</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">tmp</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">tmp</span><span class="p">].</span><span class="n">v</span><span class="p">;</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">tmp</span><span class="p">].</span><span class="n">c</span><span class="p">;</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">tmp</span><span class="p">].</span><span class="n">t</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">w</span> <span class="o">+</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="n">C</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">used</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">w</span> <span class="o">+</span> <span class="n">c</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">relax</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">queue</span><span class="p">[</span><span class="n">tail</span><span class="p">].</span><span class="n">u</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
                    <span class="n">queue</span><span class="p">[</span><span class="n">tail</span><span class="p">].</span><span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">+</span> <span class="n">c</span><span class="p">;</span>
                    <span class="n">queue</span><span class="p">[</span><span class="n">tail</span><span class="p">].</span><span class="n">t</span> <span class="o">=</span> <span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">w</span> <span class="o">+</span> <span class="n">c</span><span class="p">];</span>
                    <span class="n">tail</span><span class="o">++</span><span class="p">;</span>
                    <span class="n">push_heap</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span> <span class="n">queue</span> <span class="o">+</span> <span class="n">tail</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">cases</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">t</span><span class="p">;</span>
    <span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">cases</span><span class="p">);</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">cases</span><span class="o">--</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">first</span><span class="p">));</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">C</span><span class="p">);</span>  <span class="c1">// n:1~n
</span>        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">t</span><span class="p">);</span>
            <span class="n">add</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">t</span><span class="p">);</span>
            <span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">t</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">dij</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

        <span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">INF</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">C</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">INF</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">dis</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span><span class="err">\</span><span class="n">n</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="n">ans</span> <span class="o">==</span> <span class="n">INF</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ans</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>

<p>这个题我是用搜索做的，写了一个短小版，见下。</p>

<pre class="highlight cpp"><span class="cp">#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;queue&gt;
#include &lt;cstring&gt;
#define sz(x) ((int)(x).size())
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">NN</span> <span class="o">=</span> <span class="mi">505</span><span class="p">,</span> <span class="n">CC</span> <span class="o">=</span> <span class="mi">505</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">node</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
    <span class="n">node</span><span class="p">()</span> <span class="p">{}</span>
    <span class="n">node</span><span class="p">(</span><span class="kt">int</span> <span class="n">_v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_w</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_c</span><span class="p">)</span><span class="o">:</span><span class="n">v</span><span class="p">(</span><span class="n">_v</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">_w</span><span class="p">),</span><span class="n">c</span><span class="p">(</span><span class="n">_c</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">};</span>
<span class="k">struct</span> <span class="n">state</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
    <span class="n">state</span><span class="p">()</span> <span class="p">{}</span>
    <span class="n">state</span><span class="p">(</span><span class="kt">int</span> <span class="n">_v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_w</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_c</span><span class="p">)</span><span class="o">:</span><span class="n">v</span><span class="p">(</span><span class="n">_v</span><span class="p">),</span><span class="n">w</span><span class="p">(</span><span class="n">_w</span><span class="p">),</span><span class="n">c</span><span class="p">(</span><span class="n">_c</span><span class="p">)</span> <span class="p">{}</span>
    <span class="n">bool</span> <span class="k">operator</span> <span class="o">&lt;</span> <span class="p">(</span><span class="k">const</span> <span class="n">state</span><span class="o">&amp;</span> <span class="n">t</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">w</span> <span class="o">!=</span> <span class="n">t</span><span class="p">.</span><span class="n">w</span><span class="p">)</span> <span class="k">return</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="n">t</span><span class="p">.</span><span class="n">w</span><span class="p">;</span> <span class="k">return</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="n">t</span><span class="p">.</span><span class="n">v</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">node</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">NN</span><span class="p">];</span>
<span class="n">priority_queue</span> <span class="o">&lt;</span><span class="n">state</span><span class="o">&gt;</span> <span class="n">pq</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">vst</span><span class="p">[</span><span class="n">NN</span><span class="p">][</span><span class="n">CC</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">cas</span><span class="p">;</span>
    <span class="n">scanf</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">cas</span> <span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="n">cas</span> <span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
        <span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span><span class="o">%</span><span class="n">d</span><span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">N</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">M</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">C</span><span class="p">);</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">vst</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">vst</span><span class="p">));</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
        <span class="k">while</span><span class="p">(</span><span class="n">pq</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span>   <span class="n">pq</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">M</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
            <span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">d</span><span class="o">%</span><span class="n">d</span><span class="o">%</span><span class="n">d</span><span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">w</span><span class="p">);</span> <span class="n">u</span><span class="o">--</span><span class="p">;</span> <span class="n">v</span><span class="o">--</span><span class="p">;</span>
            <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">node</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">c</span><span class="p">));</span>
            <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">node</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">c</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">state</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
        <span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">pq</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">state</span> <span class="n">now</span> <span class="o">=</span> <span class="n">pq</span><span class="p">.</span><span class="n">top</span><span class="p">();</span> <span class="n">pq</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">now</span><span class="p">.</span><span class="n">v</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">now</span><span class="p">.</span><span class="n">c</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">now</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">vst</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">==</span> <span class="nb">true</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">v</span> <span class="o">==</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">w</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>
            <span class="n">vst</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">sz</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span> <span class="n">i</span> <span class="o">++</span> <span class="p">){</span>
                <span class="kt">int</span> <span class="n">vv</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">,</span> <span class="n">ww</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">w</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">c</span> <span class="o">+</span> <span class="n">c</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">cc</span> <span class="o">&gt;</span> <span class="n">C</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
                <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">state</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span> <span class="n">ww</span><span class="p">,</span> <span class="n">cc</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>
<p>#### Alex’s Problem</p>

<p><strong>[By Alex]</strong>根据所给的三个点确定平面，然后求出此平面与正方体的12条棱的交点（平行的不算），保留坐标三个值均在[-100,100]的交点，去掉重复的后就得到了需要求面积的多边形的全部顶点。此时可以根据顶点个数和位置判断界面类型，截面可能是三角形，平行四边形，梯形，五边形和六边形，然后再去算面积。这里还有一种更为简单的方法，需要用到以下定理：</p>

<p>空间多边形 <em>(A<sub>1</sub>,A<sub>2</sub>…A<sub>n</sub>)</em>的各顶点坐标为<em>A<sub>i</sub>(x<sub>i</sub>,y<sub>i</sub>,z<sub>i</sub>) (i = 1,2,…,n)</em>, 则它的面积为</p>

<p><a href="http://blog.oneplus.info/wp-content/uploads/2011/05/S.jpg"><img src="http://blog.oneplus.info/wp-content/uploads/2011/05/S.jpg" alt="" title="S" width="400" class="aligncenter size-full wp-image-254" /></a></p>

<p>其中</p>

<p><a href="http://blog.oneplus.info/wp-content/uploads/2011/05/T.jpg"><img src="http://blog.oneplus.info/wp-content/uploads/2011/05/T.jpg" alt="" title="T" width="400" class="aligncenter size-full wp-image-257" /></a></p>

<p>我们已经得到了所有的顶点，只需要把它们按多边形顺序顺时针或逆时针排序，而这件事也是很简单的，因为对于任何一个点，它的下一个点是跟它共面的。排好后按照上面的公式很容易就能求出面积了。</p>

<pre class="highlight cpp"><span class="cp">#include &lt;cstdlib&gt;
#include &lt;cstring&gt;
#include &lt;cstdio&gt;
#include &lt;cmath&gt;
#include &lt;algorithm&gt;
#include &lt;string&gt;
#include &lt;iostream&gt;
#include &lt;set&gt;
#include &lt;iomanip&gt;
#define eps 1e-8
#define zero(x) (((x)&gt;0?(x):-(x))&lt;eps)
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">point3</span> <span class="p">{</span>
    <span class="kt">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">;</span>

    <span class="n">point3</span><span class="p">(</span><span class="kt">double</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">double</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">point3</span> <span class="n">p</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">z</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">bool</span> <span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span> <span class="n">point3</span> <span class="n">p</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">fabs</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="o">&amp;&amp;</span> <span class="n">fabs</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="o">&amp;&amp;</span> <span class="n">fabs</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">line3</span> <span class="p">{</span>
    <span class="n">point3</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>

    <span class="n">line3</span><span class="p">(</span><span class="n">point3</span> <span class="n">a0</span><span class="p">,</span> <span class="n">point3</span> <span class="n">b0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a0</span><span class="p">;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">b0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">line3</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">plane3</span> <span class="p">{</span>
    <span class="n">point3</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>

    <span class="n">plane3</span><span class="p">(</span><span class="n">point3</span> <span class="n">a0</span><span class="p">,</span> <span class="n">point3</span> <span class="n">b0</span><span class="p">,</span> <span class="n">point3</span> <span class="n">c0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a0</span><span class="p">;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">b0</span><span class="p">;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">c0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">plane3</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="n">line3</span> <span class="nf">make_line</span><span class="p">(</span><span class="n">point3</span> <span class="n">a</span><span class="p">,</span> <span class="n">point3</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">line3</span> <span class="n">p</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">p</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="nf">dmult</span><span class="p">(</span><span class="n">point3</span> <span class="n">u</span><span class="p">,</span> <span class="n">point3</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">u</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">u</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">u</span><span class="p">.</span><span class="n">z</span> <span class="o">*</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">point3</span> <span class="nf">xmult</span><span class="p">(</span><span class="n">point3</span> <span class="n">u</span><span class="p">,</span> <span class="n">point3</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">point3</span> <span class="n">ret</span><span class="p">;</span>
    <span class="n">ret</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">u</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
    <span class="n">ret</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">z</span> <span class="o">*</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">u</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
    <span class="n">ret</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">u</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">point3</span> <span class="nf">subt</span><span class="p">(</span><span class="n">point3</span> <span class="n">u</span><span class="p">,</span> <span class="n">point3</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">point3</span> <span class="n">ret</span><span class="p">;</span>
    <span class="n">ret</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
    <span class="n">ret</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
    <span class="n">ret</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">point3</span> <span class="nf">pvec</span><span class="p">(</span><span class="n">plane3</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">xmult</span><span class="p">(</span><span class="n">subt</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">b</span><span class="p">),</span> <span class="n">subt</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">c</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">bool</span> <span class="nf">parallel</span><span class="p">(</span><span class="n">line3</span> <span class="n">l</span><span class="p">,</span> <span class="n">plane3</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">zero</span><span class="p">(</span><span class="n">dmult</span><span class="p">(</span><span class="n">subt</span><span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">l</span><span class="p">.</span><span class="n">b</span><span class="p">),</span> <span class="n">pvec</span><span class="p">(</span><span class="n">s</span><span class="p">)));</span>
<span class="p">}</span>

<span class="n">point3</span> <span class="nf">intersection</span><span class="p">(</span><span class="n">line3</span> <span class="n">l</span><span class="p">,</span> <span class="n">plane3</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">point3</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">pvec</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
    <span class="kt">double</span> <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">ret</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">ret</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">ret</span><span class="p">.</span><span class="n">z</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">z</span><span class="p">))</span> <span class="o">/</span>
            <span class="p">(</span><span class="n">ret</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">ret</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">ret</span><span class="p">.</span><span class="n">z</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">z</span><span class="p">));</span>
    <span class="n">ret</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">;</span>
    <span class="n">ret</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">;</span>
    <span class="n">ret</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">l</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">line3</span> <span class="n">edge</span><span class="p">[</span><span class="mi">15</span><span class="p">];</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">point3</span> <span class="n">p1</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
    <span class="n">point3</span> <span class="n">p2</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
    <span class="n">point3</span> <span class="n">p3</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
    <span class="n">point3</span> <span class="n">p4</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">);</span>
    <span class="n">point3</span> <span class="n">p5</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
    <span class="n">point3</span> <span class="n">p6</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">);</span>
    <span class="n">point3</span> <span class="n">p7</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">);</span>
    <span class="n">point3</span> <span class="n">p8</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">);</span>
    <span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_line</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">);</span>
    <span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_line</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p3</span><span class="p">);</span>
    <span class="n">edge</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_line</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p4</span><span class="p">);</span>
    <span class="n">edge</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_line</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p5</span><span class="p">);</span>
    <span class="n">edge</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_line</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p6</span><span class="p">);</span>
    <span class="n">edge</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_line</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">p5</span><span class="p">);</span>
    <span class="n">edge</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_line</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">p7</span><span class="p">);</span>
    <span class="n">edge</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_line</span><span class="p">(</span><span class="n">p4</span><span class="p">,</span> <span class="n">p6</span><span class="p">);</span>
    <span class="n">edge</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_line</span><span class="p">(</span><span class="n">p4</span><span class="p">,</span> <span class="n">p7</span><span class="p">);</span>
    <span class="n">edge</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_line</span><span class="p">(</span><span class="n">p5</span><span class="p">,</span> <span class="n">p8</span><span class="p">);</span>
    <span class="n">edge</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_line</span><span class="p">(</span><span class="n">p6</span><span class="p">,</span> <span class="n">p8</span><span class="p">);</span>
    <span class="n">edge</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_line</span><span class="p">(</span><span class="n">p7</span><span class="p">,</span> <span class="n">p8</span><span class="p">);</span>
    <span class="n">point3</span> <span class="n">p</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">lf</span><span class="o">%</span><span class="n">lf</span><span class="o">%</span><span class="n">lf</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">lf</span><span class="o">%</span><span class="n">lf</span><span class="o">%</span><span class="n">lf</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">z</span><span class="p">);</span>
        <span class="n">scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="n">lf</span><span class="o">%</span><span class="n">lf</span><span class="o">%</span><span class="n">lf</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">z</span><span class="p">);</span>
        <span class="n">plane3</span> <span class="n">P</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
        <span class="n">set</span><span class="o">&lt;</span><span class="n">point3</span><span class="o">&gt;</span> <span class="n">s</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">parallel</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">P</span><span class="p">))</span> <span class="p">{</span>
                <span class="n">point3</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">intersection</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">P</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">x</span> <span class="o">-</span> <span class="mi">100</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="o">&amp;&amp;</span> <span class="n">tmp</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="mi">100</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="o">&amp;&amp;</span> <span class="n">tmp</span><span class="p">.</span><span class="n">z</span> <span class="o">-</span> <span class="mi">100</span> <span class="o">&lt;</span> <span class="n">eps</span>
                        <span class="o">&amp;&amp;</span> <span class="n">tmp</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">eps</span> <span class="o">&amp;&amp;</span> <span class="n">tmp</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">eps</span> <span class="o">&amp;&amp;</span> <span class="n">tmp</span><span class="p">.</span><span class="n">z</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">eps</span><span class="p">)</span>
                    <span class="n">s</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="n">point3</span> <span class="n">list</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
        <span class="n">set</span><span class="o">&lt;</span><span class="n">point3</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">p1</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">begin</span><span class="p">());</span>
                <span class="n">s</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">begin</span><span class="p">());</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">p1</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">p1</span> <span class="o">!=</span> <span class="n">s</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="n">p1</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">fabs</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="o">*</span><span class="n">p1</span><span class="p">).</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">x</span> <span class="o">-</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="o">||</span> <span class="n">fabs</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">x</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">))</span>
                        <span class="o">||</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">y</span> <span class="o">-</span> <span class="p">(</span><span class="o">*</span><span class="n">p1</span><span class="p">).</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">y</span> <span class="o">-</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="o">||</span> <span class="n">fabs</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">y</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">))</span>
                        <span class="o">||</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">z</span> <span class="o">-</span> <span class="p">(</span><span class="o">*</span><span class="n">p1</span><span class="p">).</span><span class="n">z</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">z</span> <span class="o">-</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="o">||</span> <span class="n">fabs</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">z</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">)))</span> <span class="p">{</span>
                    <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">p1</span><span class="p">;</span>
                    <span class="n">s</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">p1</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="kt">double</span> <span class="n">s1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">s1</span> <span class="o">+=</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span> <span class="o">*</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="n">y</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">s1</span> <span class="o">-=</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span> <span class="o">*</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">y</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">s1</span> <span class="o">+=</span> <span class="n">list</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">x</span> <span class="o">*</span> <span class="n">list</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span> <span class="o">-</span> <span class="n">list</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span> <span class="o">*</span> <span class="n">list</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">y</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">s2</span> <span class="o">+=</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span> <span class="o">*</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="n">z</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">s2</span> <span class="o">-=</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span> <span class="o">*</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">z</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">s2</span> <span class="o">+=</span> <span class="n">list</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">y</span> <span class="o">*</span> <span class="n">list</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">z</span> <span class="o">-</span> <span class="n">list</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span> <span class="o">*</span> <span class="n">list</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">z</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">s3</span> <span class="o">+=</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">z</span> <span class="o">*</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="n">x</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">s3</span> <span class="o">-=</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">z</span> <span class="o">*</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">x</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">s3</span> <span class="o">+=</span> <span class="n">list</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">z</span> <span class="o">*</span> <span class="n">list</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span> <span class="o">-</span> <span class="n">list</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">z</span> <span class="o">*</span> <span class="n">list</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">x</span><span class="p">;</span>
        <span class="kt">double</span> <span class="n">S</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">s1</span> <span class="o">*</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">s2</span> <span class="o">*</span> <span class="n">s2</span> <span class="o">+</span> <span class="n">s3</span> <span class="o">*</span> <span class="n">s3</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">;</span>
        <span class="n">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="mf">.2</span><span class="n">lf</span><span class="err">\</span><span class="n">n</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="n">S</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>

<h4 id="zhou-yi-ii">Zhou Yi II</h4>

<p>系列题，可以参考<a href="http://acm.hit.edu.cn/judge/show.php?Proid=2989">这里</a></p>

<div>_________________________我是被拍死的分割线_________________________</div>

<p>网络赛最终以刷刷ak、众大牛六题收场。bin3学长、尤波学长的表现都非常惊艳呢。rank参见下面。</p>

<p><a href="http://blog.oneplus.info/wp-content/uploads/2011/05/rank.jpg"><img src="http://blog.oneplus.info/wp-content/uploads/2011/05/rank.jpg" alt="" title="rank" width="540" class="aligncenter size-full wp-image-261" /></a></p>

<p>看来谁都不能阻止刷刷AK的脚步了。</p>


</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
var disqus_shortname = 'yjliu'; // required: replace example with your forum shortname
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
 var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
 dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
 (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

  </div>

  <footer class="text-center">
    &copy; <a href="http://yjliu.net/">Static Oneplus</a> 2010 - 2014 |
    This site is built by <a href="http://middlemanapp.com/" target="_blank">Middleman</a> and
    <a href="http://getbootstrap.com/">bootstrap</a>.
  </footer>
</div>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-20774106-1', 'yjliu.net');
ga('send', 'pageview');
</script>
<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
</body>
</html>
